!function(){function t(n,a,o){return(t=e()?Reflect.construct:function(t,e,n){var a=[null];a.push.apply(a,e);var o=new(Function.bind.apply(t,a));return n&&i(o,n.prototype),o}).apply(null,arguments)}function e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{dru4:function(e,i,a){"use strict";a.r(i),a.d(i,"PointageModule",function(){return Dt});var r=a("ofXK"),s=a("tyNb"),l=a("mrSG"),u=a("fXoL"),m=a("VRyK"),b=a("3Pt+"),d=a("0IaG"),f=a("V2kc"),h=a("7q3A"),p=a("M0ag"),g=a("/t3+"),S=a("f0Cb"),y=a("kmnG"),v=a("d3UM"),R=a("qFsG"),w=a("iadO"),F=a("QibW"),k=a("bTqV"),A=a("FKr1");function C(t,e){if(1&t){var i=u.Tb();u.Sb(0,"mat-option",27),u.Zb("click",function(){u.qc(i);var t=e.$implicit;return u.dc().getPlaning(t.entity)}),u.Ac(1),u.Rb()}if(2&t){var n=e.$implicit;u.jc("value",n.id),u.Bb(1),u.Dc("",n.nom," ",n.prenom,"")}}function M(t,e){1&t&&(u.Sb(0,"mat-error"),u.Ac(1,"Horaire Non Valide!"),u.Rb())}function E(t,e){1&t&&(u.Sb(0,"mat-error"),u.Ac(1,"Horaire Non Valide!"),u.Rb())}function B(t,e){1&t&&(u.Sb(0,"mat-error"),u.Ac(1,"Horaire Non Valide!"),u.Rb())}function x(t,e){1&t&&(u.Sb(0,"mat-error"),u.Ac(1,"Horaire Non Valide!"),u.Rb())}function D(t,e){if(1&t){var i=u.Tb();u.Sb(0,"mat-radio-button",28),u.Zb("change",function(t){return u.qc(i),u.dc().radioChange(t)}),u.Ac(1),u.Rb()}if(2&t){var n=e.$implicit;u.jc("value",n.id),u.Bb(1),u.Cc(" ",n.name," ")}}function O(t,e){if(1&t&&(u.Sb(0,"mat-option",32),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.jc("value",i),u.Bb(1),u.Bc(i)}}function V(t,e){if(1&t&&(u.Sb(0,"mat-form-field",29),u.Sb(1,"mat-label"),u.Ac(2,"List des Absences Justifi\xe9s"),u.Rb(),u.Sb(3,"mat-select",30),u.yc(4,O,2,2,"mat-option",31),u.Rb(),u.Rb()),2&t){var i=u.dc();u.Bb(4),u.jc("ngForOf",i.uow.absences)}}var j,P=((j=function(){function t(e,i,n,a,r){o(this,t),this.dialogRef=e,this.data=i,this.fb=n,this.uow=a,this.session=r,this.subs=[],this.title="",this.edition=!1,this.collaborateurs=this.uow.collaborateurs.get(),this.total=0,this.entity=""}return c(t,[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.o=this.data.model,this.title=this.data.title,this.edition=this.data.edition,this.o.idUser&&0!==this.o.idUser||(this.o.idUser=this.session.user.id),this.createForm(),this.total=this.uow.deffMinute(this.o),this.getPlaning(this.o.entity);case 1:case"end":return t.stop()}},t,this)}))}},{key:"imputChange",value:function(t){if(console.log(this.myForm.get("pointageOption").value),this.total=this.uow.deffMinute(this.myForm.value),this.planing){var e=this.uow.calculeLateness(this.myForm.value,this.planing),i=e.comment,n=e.retardMatin,a=e.anticipationMatin,o=e.retardSoire,r=e.anticipationSoire;this.myForm.get("commentaire").setValue(i),this.myForm.get("retardMatin").setValue(n),this.myForm.get("anticipationMatin").setValue(a),this.myForm.get("retardSoire").setValue(o),this.myForm.get("anticipationSoire").setValue(r)}0===this.total&&this.myForm.get("pointageOption").setValue(3)}},{key:"radioChange",value:function(t){switch(t.value){case 0:if(this.planing){var e=this.uow.calculeLateness(this.myForm.value,this.planing),i=e.comment,n=e.retardMatin,a=e.anticipationMatin,o=e.retardSoire,r=e.anticipationSoire;this.myForm.get("commentaire").setValue(i),this.myForm.get("retardMatin").setValue(n),this.myForm.get("anticipationMatin").setValue(a),this.myForm.get("retardSoire").setValue(o),this.myForm.get("anticipationSoire").setValue(r)}break;case 1:this.myForm.get("matinEntree").setValue("00:00"),this.myForm.get("matinSortie").setValue("00:00"),this.myForm.get("soireEntree").setValue("00:00"),this.myForm.get("soireSortie").setValue("00:00"),this.total=this.uow.deffMinute(this.myForm.value),this.myForm.get("commentaire").setValue(this.uow.pointageOptions[1].name);break;case 2:this.myForm.get("matinEntree").setValue(this.planing.matinEntree),this.myForm.get("matinSortie").setValue(this.planing.matinSortie),this.myForm.get("soireEntree").setValue(this.planing.soireEntree),this.myForm.get("soireSortie").setValue(this.planing.soireSortie),this.total=this.uow.deffMinute(this.myForm.value),this.myForm.get("commentaire").setValue(this.uow.pointageOptions[2].name);break;case 3:this.myForm.get("matinEntree").setValue("00:00"),this.myForm.get("matinSortie").setValue("00:00"),this.myForm.get("soireEntree").setValue("00:00"),this.myForm.get("soireSortie").setValue("00:00"),this.total=this.uow.deffMinute(this.myForm.value),this.myForm.get("commentaire").setValue(this.uow.pointageOptions[3].name)}}},{key:"getPlaning",value:function(t){var e=this;if(this.entity!==t){this.planing=null,this.entity=t;var i=new Date(this.myForm.get("date").value);this.uow.planings.getPlaning(t,i.getDay()).subscribe(function(t){e.planing=t.p})}}},{key:"onNoClick",value:function(){this.dialogRef.close()}},{key:"onOkClick",value:function(t){var e,i=this;t.date=this.uow.valideDate(t.date),t.totalHeurs=this.total,e=this.uow.pointages.post(t).subscribe(function(e){i.dialogRef.close(t)}),this.subs.push(e)}},{key:"createForm",value:function(){this.myForm=this.fb.group({date:[this.o.date,[b.t.required]],idCollaborateur:[this.o.idCollaborateur,[b.t.required,b.t.min(1)]],time:[this.o.time],moment:[this.o.moment,[b.t.required]],etat:[this.o.etat,[b.t.required]],matinEntree:[this.o.matinEntree,[this.timeValidation]],matinSortie:[this.o.matinSortie,[this.timeValidation]],soireEntree:[this.o.soireEntree,[this.timeValidation]],soireSortie:[this.o.soireSortie,[this.timeValidation]],totalHeurs:[this.o.totalHeurs,[]],retardMatin:[this.o.retardMatin,[]],anticipationMatin:[this.o.anticipationMatin,[]],retardSoire:[this.o.retardSoire,[]],anticipationSoire:[this.o.anticipationSoire,[]],pointageOption:[this.o.pointageOption,[]],commentaire:[this.o.commentaire,[]],idUser:[this.o.idUser,[b.t.required,b.t.min(1)]]})}},{key:"resetForm",value:function(){this.o=new f.e,this.createForm()}},{key:"timeValidation",value:function(t){var e=t.value;return!e||2===e.indexOf(":")&&5===e.length?null:{timeError:!0}}},{key:"ngOnDestroy",value:function(){this.subs.forEach(function(t){t.unsubscribe()})}}]),t}()).\u0275fac=function(t){return new(t||j)(u.Mb(d.g),u.Mb(d.a),u.Mb(b.d),u.Mb(h.a),u.Mb(p.c))},j.\u0275cmp=u.Gb({type:j,selectors:[["app-update"]],decls:63,vars:19,consts:[[1,"dialog"],["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"content"],[1,"row","m-0",3,"formGroup"],["appearance","fill",1,"col-md-6"],["formControlName","idCollaborateur"],[3,"value","click",4,"ngFor","ngForOf"],["matInput","","formControlName","date",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],["appearance","fill",1,"col-md-4"],["matInput","","formControlName","matinEntree","placeholder","00:00",3,"ngModelChange"],[4,"ngIf"],["matInput","","formControlName","matinSortie","placeholder","00:00",3,"ngModelChange"],[1,"col-md-4"],["matInput","","formControlName","soireEntree","placeholder","00:00",3,"ngModelChange"],["matInput","","formControlName","soireSortie","placeholder","00:00",3,"ngModelChange"],["matInput","","readonly","",3,"value"],[1,"col-md-12"],[1,"col-md-3","mb-5","mt-4"],["formControlName","pointageOption",1,"d-flex","flex-column",3,"disabled"],["labelPosition","before",3,"value","change",4,"ngFor","ngForOf"],["class","col-md-4","style","margin-top: 25px;",4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"],[3,"value","click"],["labelPosition","before",3,"value","change"],[1,"col-md-4",2,"margin-top","25px"],["formControlName","commentaire"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){if(1&t&&(u.Sb(0,"div",0),u.Sb(1,"h1",1),u.Sb(2,"mat-toolbar",2),u.Sb(3,"span"),u.Ac(4),u.Rb(),u.Rb(),u.Nb(5,"mat-divider"),u.Rb(),u.Sb(6,"div",3),u.Sb(7,"mat-dialog-content"),u.Sb(8,"form",4),u.Sb(9,"mat-form-field",5),u.Sb(10,"mat-label"),u.Ac(11,"collaborateurs"),u.Rb(),u.Sb(12,"mat-select",6),u.yc(13,C,2,3,"mat-option",7),u.ec(14,"async"),u.Rb(),u.Rb(),u.Sb(15,"mat-form-field",5),u.Sb(16,"mat-label"),u.Ac(17,"date"),u.Rb(),u.Nb(18,"input",8),u.Nb(19,"mat-datepicker-toggle",9),u.Nb(20,"mat-datepicker",null,10),u.Rb(),u.Sb(22,"mat-form-field",11),u.Sb(23,"mat-label"),u.Ac(24,"Entr\xe9e (Matin)"),u.Rb(),u.Sb(25,"input",12),u.Zb("ngModelChange",function(t){return e.imputChange(t)}),u.Rb(),u.yc(26,M,2,0,"mat-error",13),u.Rb(),u.Sb(27,"mat-form-field",11),u.Sb(28,"mat-label"),u.Ac(29,"Sortie (Matin)"),u.Rb(),u.Sb(30,"input",14),u.Zb("ngModelChange",function(t){return e.imputChange(t)}),u.Rb(),u.yc(31,E,2,0,"mat-error",13),u.Rb(),u.Nb(32,"div",15),u.Sb(33,"mat-form-field",11),u.Sb(34,"mat-label"),u.Ac(35,"Entr\xe9e (Soir)"),u.Rb(),u.Sb(36,"input",16),u.Zb("ngModelChange",function(t){return e.imputChange(t)}),u.Rb(),u.yc(37,B,2,0,"mat-error",13),u.Rb(),u.Sb(38,"mat-form-field",11),u.Sb(39,"mat-label"),u.Ac(40,"Sortie (Soir)"),u.Rb(),u.Sb(41,"input",17),u.Zb("ngModelChange",function(t){return e.imputChange(t)}),u.Rb(),u.yc(42,x,2,0,"mat-error",13),u.Rb(),u.Sb(43,"mat-form-field",11),u.Sb(44,"mat-label"),u.Ac(45,"Total"),u.Rb(),u.Nb(46,"input",18),u.Rb(),u.Sb(47,"div",19),u.Sb(48,"p"),u.Ac(49),u.Rb(),u.Sb(50,"p"),u.Ac(51),u.Rb(),u.Sb(52,"p"),u.Ac(53),u.Rb(),u.Rb(),u.Sb(54,"div",20),u.Sb(55,"mat-radio-group",21),u.yc(56,D,2,2,"mat-radio-button",22),u.Rb(),u.Rb(),u.yc(57,V,5,1,"mat-form-field",23),u.Rb(),u.Rb(),u.Sb(58,"mat-dialog-actions",24),u.Sb(59,"button",25),u.Zb("click",function(){return e.onNoClick()}),u.Ac(60,"Annuler"),u.Rb(),u.Sb(61,"button",26),u.Zb("click",function(){return e.onOkClick(e.myForm.getRawValue())}),u.Ac(62,"Enregistre"),u.Rb(),u.Rb(),u.Rb(),u.Rb()),2&t){var i=u.oc(21);u.Bb(4),u.Bc(e.title),u.Bb(4),u.jc("formGroup",e.myForm),u.Bb(5),u.jc("ngForOf",u.fc(14,17,e.collaborateurs)),u.Bb(5),u.jc("matDatepicker",i),u.Bb(1),u.jc("for",i),u.Bb(7),u.jc("ngIf",null==e.myForm.get("matinEntree").errors?null:e.myForm.get("matinEntree").errors.timeError),u.Bb(5),u.jc("ngIf",null==e.myForm.get("matinSortie").errors?null:e.myForm.get("matinSortie").errors.timeError),u.Bb(6),u.jc("ngIf",null==e.myForm.get("soireEntree").errors?null:e.myForm.get("soireEntree").errors.timeError),u.Bb(5),u.jc("ngIf",null==e.myForm.get("soireSortie").errors?null:e.myForm.get("soireSortie").errors.timeError),u.Bb(4),u.jc("value",(e.total/60).toFixed(2)),u.Bb(3),u.Cc("Retard : ",+e.myForm.get("retardMatin").value+ +e.myForm.get("retardSoire").value,""),u.Bb(2),u.Cc("Anticipation : ",+e.myForm.get("anticipationMatin").value+ +e.myForm.get("anticipationSoire").value,""),u.Bb(2),u.Cc("Commentaire : ",e.myForm.get("commentaire").value,""),u.Bb(2),u.jc("disabled",!e.planing),u.Bb(1),u.jc("ngForOf",e.uow.pointageOptions),u.Bb(1),u.jc("ngIf",1===e.myForm.get("pointageOption").value),u.Bb(4),u.jc("disabled",e.myForm.invalid)}},directives:[d.h,g.a,S.a,d.e,b.u,b.o,b.h,y.c,y.f,v.a,b.n,b.g,r.k,R.b,b.c,w.e,w.h,y.g,w.d,r.l,F.b,d.c,k.a,A.m,y.b,F.a],pipes:[r.b],styles:[""]}),j),N=a("M9IT"),I=a("Dh3D"),H=a("JX91"),T=a("QZ4V"),$=a("AytR"),Z=a("qQ+2"),L=a("hUFt"),Q=a("NFeN"),q=a("7EHt"),U=a("n1FK"),_=a("+0xr"),G=a("Xa2L"),z=["tb"];function J(t,e){if(1&t&&(u.Sb(0,"mat-option",45),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.jc("value",i),u.Bb(1),u.Bc(i)}}function K(t,e){if(1&t&&(u.Sb(0,"mat-option",45),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.jc("value",i.id),u.Bb(1),u.Bc(i.nom)}}function X(t,e){1&t&&u.Nb(0,"mat-spinner")}function Y(t,e){if(1&t&&(u.Sb(0,"div",46),u.yc(1,X,1,0,"mat-spinner",47),u.Rb()),2&t){var i=u.dc();u.Bb(1),u.jc("ngIf",i.isLoadingResults)}}function W(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1,"Entiti\xe9e"),u.Rb())}function tt(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(i.entity)}}function et(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1,"Collaborateur"),u.Rb())}function it(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(i.collaborateur)}}function nt(t,e){1&t&&(u.Sb(0,"th",50),u.Ac(1,"Date"),u.Rb())}function at(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.ec(2,"date"),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(u.gc(2,1,i.date,"dd/MM/yyyy"))}}function ot(t,e){1&t&&(u.Sb(0,"th",50),u.Ac(1,"Entr\xe9e (Matin)"),u.Rb())}function rt(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(""!==i.matinEntree?i.matinEntree:"--:--")}}function ct(t,e){1&t&&(u.Sb(0,"th",50),u.Ac(1,"Sortie (Matin)"),u.Rb())}function st(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(""!==i.matinSortie?i.matinSortie:"--:--")}}function lt(t,e){1&t&&(u.Sb(0,"th",50),u.Ac(1,"Entr\xe9e (Soir)"),u.Rb())}function ut(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(""!==i.soireEntree?i.soireEntree:"--:--")}}function mt(t,e){1&t&&(u.Sb(0,"th",50),u.Ac(1,"Sortie (Soir)"),u.Rb())}function bt(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc(""!==i.soireSortie?i.soireSortie:"--:--")}}function dt(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1,"Resultat"),u.Rb())}function ft(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit,n=u.dc();u.Bb(1),u.Cc(" ",n.uow.pointageOptions[i.pointageOption].name,"")}}function ht(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1,"Commentaire"),u.Rb())}function pt(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Cc(" ",i.commentaire&&""!==i.commentaire?i.commentaire:"RAS","")}}function gt(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1,"Total"),u.Rb())}function St(t,e){if(1&t&&(u.Sb(0,"td",49),u.Ac(1),u.Rb()),2&t){var i=e.$implicit;u.Bb(1),u.Bc((i.totalHeurs/60).toFixed(2))}}function yt(t,e){1&t&&(u.Sb(0,"th",48),u.Ac(1," options "),u.Rb())}function vt(t,e){if(1&t){var i=u.Tb();u.Sb(0,"td",49),u.Sb(1,"div",51),u.Sb(2,"button",52),u.Zb("click",function(){u.qc(i);var t=e.$implicit;return u.dc().edit(t)}),u.Sb(3,"mat-icon"),u.Ac(4,"create"),u.Rb(),u.Rb(),u.Sb(5,"button",53),u.Zb("click",function(){u.qc(i);var t=e.$implicit;return u.dc().delete(t)}),u.Sb(6,"mat-icon"),u.Ac(7,"delete_sweep"),u.Rb(),u.Rb(),u.Rb(),u.Rb()}}function Rt(t,e){1&t&&u.Nb(0,"tr",54)}function wt(t,e){1&t&&u.Nb(0,"tr",55)}var Ft,kt,At,Ct=function(){return[10,25,50,100,250]},Mt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(Ft=function(){function e(t,i,n,a,r,c,s){o(this,e),this.uow=t,this.dialog=i,this.excel=n,this.mydialog=a,this.url=r,this.pdf=c,this.session=s,this.update=new u.o,this.isLoadingResults=!0,this.resultsLength=0,this.isRateLimitReached=!1,this.isDev=!$.a.production,this.subs=[],this.dataSource=[],this.selectedList=[],this.displayedColumns=["collaborateur","entity","date","matinEntree","matinSortie","soireEntree","soireSortie","totalHeurs","pointageOption","commentaire","option"],this.panelOpenState=!1,this.idCollaborateur=new b.e(0),this.matinEntree=new b.e(""),this.matinSortie=new b.e(""),this.soireEntree=new b.e(""),this.soireSortie=new b.e(""),this.idUser=new b.e(0),this.entity=new b.e(""),this.d1=new b.e(new Date),this.d2=new b.e(new Date),this.toDay=new Date,this.collaborateurs=[],this.users=this.uow.users.get(),this.entities=T}return c(e,[{key:"ngOnInit",value:function(){var t=this,e=Object(m.a)(this.sort.sortChange,this.paginator.page,this.update).pipe(Object(H.a)(null)).subscribe(function(e){!0===e?t.paginator.pageIndex=0:e=e,t.paginator.pageSize?e=e:t.paginator.pageSize=10;var i=t.paginator.pageIndex*t.paginator.pageSize;t.isLoadingResults=!0,t.getPage(i,t.paginator.pageSize,t.sort.active?t.sort.active:"date",t.sort.direction?t.sort.direction:"asc",""===t.entity.value?"*":t.entity.value,0===t.idCollaborateur.value?0:t.idCollaborateur.value,""===t.matinEntree.value?"*":t.matinEntree.value,""===t.matinSortie.value?"*":t.matinSortie.value,""===t.soireEntree.value?"*":t.soireEntree.value,""===t.soireSortie.value?"*":t.soireSortie.value,0===t.idUser.value?0:t.idUser.value,t.uow.valideDate(t.d1.value).toISOString(),t.uow.valideDate(t.d2.value).toISOString())});this.subs.push(e)}},{key:"generatePdf",value:function(){var t=this,e=[["Entiti\xe9e","Collaborateur","Date","Entr\xe9e (Matin)","Sortie (Matin)","Entr\xe9e (Soir)","Sortie (Soir)","Total","Resultat","Commentaire"].map(function(t){return{text:t}})];this.dataSource.map(function(i){e.push([{text:i.entity},{text:i.collaborateur},{text:new r.e("fr-FR").transform(i.date,"dd/MM/yyyy")},{text:i.matinEntree},{text:i.matinSortie},{text:i.soireEntree},{text:i.soireSortie},{text:i.totalHeurs},{text:t.uow.pointageOptions[i.pointageOption].name},{text:i.commentaire}])}),this.pdf.generatePdf(e,"A4","".concat(this.session.user.nom," ").concat(this.session.user.prenom),"Historique Pointage")}},{key:"generateExcel",value:function(){var t=this,e=this.dataSource.map(function(e,i){return{"Entiti\xe9e":e.entity,Collaborateur:e.collaborateur,Date:new r.e("fr-FR").transform(e.date,"dd/MM/yyyy"),"Entr\xe9e (Matin)":e.matinEntree,"Sortie (Matin)":e.matinSortie,"Entr\xe9e (Soir)":e.soireEntree,"Sortie (Soir)":e.soireSortie,Total:e.totalHeurs,Resultat:t.uow.pointageOptions[e.pointageOption].name,Commentaire:e.commentaire}});this.excel.json_to_sheet(e)}},{key:"selectChange",value:function(t){var e=this;this.uow.collaborateurs.getByForeignkey(t).subscribe(function(t){e.collaborateurs=t})}},{key:"reset",value:function(){this.idCollaborateur.setValue(0),this.matinEntree.setValue(""),this.matinSortie.setValue(""),this.soireEntree.setValue(""),this.soireSortie.setValue(""),this.idUser.setValue(0),this.entity.setValue(""),this.d1.setValue(new Date),this.d2.setValue(new Date),this.update.next(!0)}},{key:"search",value:function(){this.update.next(!0)}},{key:"trackFn",value:function(t,e){return e.progressValue}},{key:"getPage",value:function(t,e,i,n,a,o,r,c,s,l,u,m,b){var d=this,f=this.uow.pointages.getAll(t,e,i,n,a,o,r,c,s,l,u,m,b).subscribe(function(t){console.log(t.list),d.dataSource=t.list,d.resultsLength=t.count,d.isLoadingResults=!1});this.subs.push(f)}},{key:"openDialog",value:function(t,e,i){return this.dialog.open(P,{width:"1100px",disableClose:!0,data:{model:t,title:e,edition:i}}).afterClosed()}},{key:"add",value:function(){var t=this;this.openDialog(new f.e,"Actualisation Pointage",!1).subscribe(function(e){e&&t.update.next(!0)})}},{key:"edit",value:function(t){var e=this;this.openDialog(t,"Actualisation Pointage",!0).subscribe(function(t){t&&e.update.next(!0)})}},{key:"deff",value:function(e){var i=new Date(e.date),a=0;if(""!==e.matinEntree&&""!==e.matinSortie){var o=t(Date,[i.getFullYear(),i.getMonth(),i.getDate()].concat(n(e.matinEntree.split(":").map(function(t){return+t})))),r=t(Date,[i.getFullYear(),i.getMonth(),i.getDate()].concat(n(e.matinSortie.split(":").map(function(t){return+t}))));a=Math.floor(Math.abs(r.getTime()-o.getTime())/6e4)}if(""!==e.soireEntree&&""!==e.soireSortie){var c=t(Date,[i.getFullYear(),i.getMonth(),i.getDate()].concat(n(e.soireEntree.split(":").map(function(t){return+t})))),s=t(Date,[i.getFullYear(),i.getMonth(),i.getDate()].concat(n(e.soireSortie.split(":").map(function(t){return+t}))));a+=Math.floor(Math.abs(s.getTime()-c.getTime())/6e4)}return"".concat(Math.floor(a/60)," heur(s) et ").concat((a%60).toFixed(0)," minute")}},{key:"delete",value:function(t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var i,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mydialog.openDialog("Pointage").toPromise();case 2:if(e.t0=e.sent,"ok"!==e.t0){e.next=6;break}i=this.uow.pointages.deleteOverride(t.idCollaborateur,t.date).subscribe(function(){return n.update.next(!0)}),this.subs.push(i);case 6:case"end":return e.stop()}},e,this)}))}},{key:"displayImage",value:function(t){return t?t&&t.startsWith("http")?t:"".concat(this.url,"/pointages/").concat(t.replace(";","")):"assets/404.jpg"}},{key:"imgError",value:function(t){t.src="assets/404.jpg"}},{key:"ngOnDestroy",value:function(){this.subs.forEach(function(t){t.unsubscribe()})}}]),e}(),Ft.\u0275fac=function(t){return new(t||Ft)(u.Mb(h.a),u.Mb(d.b),u.Mb(Z.a),u.Mb(L.a),u.Mb("BASE_URL"),u.Mb(p.b),u.Mb(p.c))},Ft.\u0275cmp=u.Gb({type:Ft,selectors:[["app-pointage"]],viewQuery:function(t,e){var i;1&t&&(u.Gc(z,!0),u.uc(N.a,!0),u.uc(I.a,!0)),2&t&&(u.nc(i=u.ac())&&(e.tb=i.first),u.nc(i=u.ac())&&(e.paginator=i.first),u.nc(i=u.ac())&&(e.sort=i.first))},decls:113,vars:24,consts:[[1,"d-flex","flex-row-reverse","pt-3","mb-3"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],["expanded","",3,"opened","closed"],[1,"d-flex","align-items-center"],[1,"mb-0","ml-2"],[1,"mt-2"],["appearance","fill",1,"col-md-6"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],["picker1",""],["picker",""],[3,"formControl","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"formControl"],["value","0"],[1,"d-flex","flex-row-reverse","mb-2","mr-2"],["mat-raised-button","",3,"click"],[1,"example-container","mat-elevation-z8","mt-2"],["class","example-loading-shade",4,"ngIf"],["id","tb",1,"example-table-container"],["tb",""],["id","user",1,"d-flex","justify-content-between","my-4","px-2",2,"display","none !important"],["mat-table","","multiTemplateDataRows","","aria-label","Elements","matSort","",3,"dataSource","trackBy"],["table",""],["matColumnDef","entity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","collaborateur"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","matinEntree"],["matColumnDef","matinSortie"],["matColumnDef","soireEntree"],["matColumnDef","soireSortie"],["matColumnDef","pointageOption"],["matColumnDef","commentaire"],["matColumnDef","totalHeurs"],["matColumnDef","option",2,"flex-direction","row-reverse"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["pageIndex","0","pageSize","10","showFirstLastButtons","",3,"length","pageSizeOptions"],["paginator",""],[3,"value"],[1,"example-loading-shade"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],[1,"button-row"],["title","Modifier","mat-icon-button","","color","accent",3,"click"],["title","Supprimer","mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){if(1&t&&(u.Sb(0,"div",0),u.Sb(1,"button",1),u.Zb("click",function(){return e.add()}),u.Sb(2,"mat-icon"),u.Ac(3,"edit"),u.Rb(),u.Ac(4," Pointage "),u.Rb(),u.Ac(5," \xa0 "),u.Sb(6,"button",2),u.Zb("click",function(){return e.generateExcel()}),u.Sb(7,"mat-icon"),u.Ac(8,"cloud_download"),u.Rb(),u.Ac(9," Excel "),u.Rb(),u.Ac(10," \xa0 "),u.Sb(11,"button",3),u.Zb("click",function(){return e.generatePdf()}),u.Sb(12,"mat-icon"),u.Ac(13,"cloud_download"),u.Rb(),u.Ac(14," Pdf "),u.Rb(),u.Rb(),u.Sb(15,"mat-accordion"),u.Sb(16,"mat-expansion-panel",4),u.Zb("opened",function(){return e.panelOpenState=!0})("closed",function(){return e.panelOpenState=!1}),u.Sb(17,"mat-expansion-panel-header"),u.Sb(18,"mat-panel-title",5),u.Sb(19,"mat-icon"),u.Ac(20,"search"),u.Rb(),u.Sb(21,"p",6),u.Ac(22,"Recherche"),u.Rb(),u.Rb(),u.Nb(23,"mat-panel-description"),u.Rb(),u.Nb(24,"mat-divider"),u.Sb(25,"div",7),u.Sb(26,"mat-form-field",8),u.Sb(27,"mat-label"),u.Ac(28,"date du"),u.Rb(),u.Nb(29,"input",9),u.Nb(30,"mat-datepicker-toggle",10),u.Nb(31,"ngx-mat-datetime-picker",null,11),u.Rb(),u.Sb(33,"mat-form-field",8),u.Sb(34,"mat-label"),u.Ac(35,"date au"),u.Rb(),u.Nb(36,"input",9),u.Nb(37,"mat-datepicker-toggle",10),u.Nb(38,"ngx-mat-datetime-picker",null,12),u.Rb(),u.Sb(40,"mat-form-field",8),u.Sb(41,"mat-label"),u.Ac(42,"entities"),u.Rb(),u.Sb(43,"mat-select",13),u.Zb("selectionChange",function(t){return e.selectChange(t.value)}),u.Sb(44,"mat-option",14),u.Ac(45,"Tous"),u.Rb(),u.yc(46,J,2,2,"mat-option",15),u.Rb(),u.Rb(),u.Sb(47,"mat-form-field",8),u.Sb(48,"mat-label"),u.Ac(49,"collaborateur"),u.Rb(),u.Sb(50,"mat-select",16),u.Sb(51,"mat-option",17),u.Ac(52,"Tous"),u.Rb(),u.yc(53,K,2,2,"mat-option",15),u.Rb(),u.Rb(),u.Rb(),u.Sb(54,"div",18),u.Sb(55,"button",19),u.Zb("click",function(){return e.reset()}),u.Sb(56,"mat-icon"),u.Ac(57,"refresh"),u.Rb(),u.Ac(58," R\xe9initialiser "),u.Rb(),u.Ac(59," \xa0\xa0 "),u.Sb(60,"button",1),u.Zb("click",function(){return e.search()}),u.Sb(61,"mat-icon"),u.Ac(62,"search"),u.Rb(),u.Ac(63," FIltrer "),u.Rb(),u.Rb(),u.Rb(),u.Rb(),u.Sb(64,"div",20),u.yc(65,Y,2,1,"div",21),u.Sb(66,"div",22,23),u.Sb(68,"div",24),u.Sb(69,"h3"),u.Ac(70),u.Rb(),u.Sb(71,"h3"),u.Ac(72),u.ec(73,"date"),u.Rb(),u.Rb(),u.Sb(74,"table",25,26),u.Qb(76,27),u.yc(77,W,2,0,"th",28),u.yc(78,tt,2,1,"td",29),u.Pb(),u.Qb(79,30),u.yc(80,et,2,0,"th",28),u.yc(81,it,2,1,"td",29),u.Pb(),u.Qb(82,31),u.yc(83,nt,2,0,"th",32),u.yc(84,at,3,4,"td",29),u.Pb(),u.Qb(85,33),u.yc(86,ot,2,0,"th",32),u.yc(87,rt,2,1,"td",29),u.Pb(),u.Qb(88,34),u.yc(89,ct,2,0,"th",32),u.yc(90,st,2,1,"td",29),u.Pb(),u.Qb(91,35),u.yc(92,lt,2,0,"th",32),u.yc(93,ut,2,1,"td",29),u.Pb(),u.Qb(94,36),u.yc(95,mt,2,0,"th",32),u.yc(96,bt,2,1,"td",29),u.Pb(),u.Qb(97,37),u.yc(98,dt,2,0,"th",28),u.yc(99,ft,2,1,"td",29),u.Pb(),u.Qb(100,38),u.yc(101,ht,2,0,"th",28),u.yc(102,pt,2,1,"td",29),u.Pb(),u.Qb(103,39),u.yc(104,gt,2,0,"th",28),u.yc(105,St,2,1,"td",29),u.Pb(),u.Qb(106,40),u.yc(107,yt,2,0,"th",28),u.yc(108,vt,8,0,"td",29),u.Pb(),u.yc(109,Rt,1,0,"tr",41),u.yc(110,wt,1,0,"tr",42),u.Rb(),u.Rb(),u.Nb(111,"mat-paginator",43,44),u.Rb()),2&t){var i=u.oc(32),n=u.oc(39);u.Bb(29),u.jc("ngxMatDatetimePicker",i)("formControl",e.d1),u.Bb(1),u.jc("for",i),u.Bb(6),u.jc("ngxMatDatetimePicker",n)("formControl",e.d2),u.Bb(1),u.jc("for",n),u.Bb(6),u.jc("formControl",e.entity),u.Bb(3),u.jc("ngForOf",e.entities),u.Bb(4),u.jc("formControl",e.idCollaborateur),u.Bb(3),u.jc("ngForOf",e.collaborateurs),u.Bb(12),u.jc("ngIf",e.isLoadingResults),u.Bb(5),u.Dc("",e.session.user.nom," ",e.session.user.prenom,""),u.Bb(2),u.Bc(u.gc(73,20,e.toDay,"dd/MM/yyyy HH:mm")),u.Bb(2),u.jc("dataSource",e.dataSource)("trackBy",e.trackFn),u.Bb(35),u.jc("matHeaderRowDef",e.displayedColumns),u.Bb(1),u.jc("matRowDefColumns",e.displayedColumns),u.Bb(1),u.jc("length",e.resultsLength)("pageSizeOptions",u.kc(23,Ct))}},directives:[k.a,Q.a,q.a,q.c,q.e,q.f,q.d,S.a,y.c,y.f,R.b,U.c,b.c,b.n,b.f,w.h,y.g,U.d,v.a,A.m,r.k,r.l,_.n,I.a,_.c,_.i,_.b,_.k,_.m,N.a,G.b,_.h,_.a,I.b,_.j,_.l],pipes:[r.e],styles:["img[_ngcontent-%COMP%]{height:60px;width:60px;padding:3px}"]}),Ft)}],Et=((kt=function t(){o(this,t)}).\u0275mod=u.Kb({type:kt}),kt.\u0275inj=u.Jb({factory:function(t){return new(t||kt)},imports:[[s.h.forChild(Mt)],s.h]}),kt),Bt=a("tk/3"),xt=a("WU52"),Dt=((At=function t(){o(this,t)}).\u0275mod=u.Kb({type:At}),At.\u0275inj=u.Jb({factory:function(t){return new(t||At)},providers:[{provide:A.f,useValue:"fr-FR"}],imports:[[r.c,Et,Bt.c,b.i,b.r,U.e,U.f,xt.a,G.a,_.o,Q.b,k.b,y.e,N.b,q.b,S.b,d.f,g.b,I.c,R.c,v.b,w.g,F.c]]}),At)}}])}();